<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Centelha - Assistente da Oficina FG Motos</title>
    <!--
        CORREÇÃO FINAL APLICADA: Incluído explicitamente 'https://www.googleapis.com' no 'connect-src'
        para permitir a comunicação do Firebase Authentication, resolvendo o último bloqueio.
    -->
    <meta http-equiv="Content-Security-Policy" 
        content="connect-src 'self' https://*.firebaseio.com wss://*.firebaseio.com https://us-central1-oficina-fg-motos.cloudfunctions.net https://www.gstatic.com https://unpkg.com https://www.googleapis.com;
                 default-src 'self' https://www.gstatic.com; 
                 script-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com https://unpkg.com https://www.gstatic.com; 
                 style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; 
                 font-src 'self' https://fonts.gstatic.com;
                 frame-src 'self';
                 object-src 'none';
                 base-uri 'self';">

    <!-- Tailwind CSS (loaded from CDN) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body { font-family: 'Inter', sans-serif; }
        /* Custom scrollbar for chat window */
        .chat-window::-webkit-scrollbar { width: 8px; }
        .chat-window::-webkit-scrollbar-thumb { background: #555; border-radius: 4px; }
        .chat-window::-webkit-scrollbar-thumb:hover { background: #666; }
        /* Typing indicator dots */
        .typing-indicator span {
            display: inline-block;
            width: 8px;
            height: 8px;
            margin: 0 2px;
            background-color: #fca311;
            border-radius: 50%;
            opacity: 0;
            animation: typing 1s infinite;
        }
        .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
        .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }
        @keyframes typing { 0%, 100% { opacity: 0; transform: translateY(0); } 50% { opacity: 1; transform: translateY(-3px); } }
        /* General button styling */
        .chat-action-button {
            display: inline-block;
            padding: 8px 12px;
            margin-top: 8px;
            border-radius: 12px;
            font-size: 0.875rem; /* text-sm */
            font-weight: 600; /* semibold */
            box-shadow: 0 2px 4px rgba(0,0,0,0.15);
            transition: transform 0.1s;
        }
        .chat-action-button:hover {
            transform: scale(1.02);
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body class="bg-gray-900 min-h-screen flex items-center justify-center p-4">

    <!-- Chat Container -->
    <div id="chat-container" class="w-full max-w-lg h-[90vh] bg-gray-800 rounded-2xl shadow-2xl flex flex-col overflow-hidden">
        
        <!-- Header -->
        <header class="p-4 bg-gray-700 text-white flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <div class="w-8 h-8 flex items-center justify-center bg-yellow-500 rounded-full">
                    <i data-lucide="zap" class="w-5 h-5 text-gray-900"></i>
                </div>
                <h1 class="text-xl font-bold">Centelha | FG Motos</h1>
            </div>
            <button id="new-chat-btn" class="text-sm text-gray-300 hover:text-white transition-colors flex items-center space-x-1 p-2 rounded-lg bg-gray-600 hover:bg-gray-500">
                <i data-lucide="refresh-cw" class="w-4 h-4"></i>
                <span>Novo Chat</span>
            </button>
        </header>

        <!-- Messages Window -->
        <div id="chat-window" class="flex-grow p-4 space-y-4 overflow-y-auto chat-window">
            <div id="chat-messages" class="flex flex-col space-y-4">
                <!-- Messages will be injected here by app.js -->
            </div>
        </div>

        <!-- Quick Replies -->
        <div id="quick-replies-container" class="p-3 flex flex-wrap gap-2 justify-start border-t border-gray-700">
            <!-- Quick replies buttons will be injected here -->
        </div>

        <!-- Input Area -->
        <div class="p-4 border-t border-gray-700 flex space-x-3">
            <input type="text" id="chat-input" placeholder="Digite sua mensagem..." class="flex-grow p-3 rounded-xl bg-gray-700 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-yellow-500 transition-shadow" autocomplete="off">
            <button id="send-btn" class="w-12 h-12 flex items-center justify-center rounded-full bg-gradient-to-br from-yellow-500 to-orange-600 text-white shadow-lg hover:from-yellow-400 hover:to-orange-500 transition-all disabled:opacity-50" disabled>
                <i data-lucide="send" class="w-5 h-5"></i>
            </button>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmation-modal" class="fixed inset-0 z-50 bg-gray-900 bg-opacity-75 hidden items-center justify-center">
        <div class="bg-gray-800 p-6 rounded-xl shadow-2xl max-w-sm w-full text-white">
            <h3 class="text-lg font-bold mb-4">Confirmação</h3>
            <p id="modal-text" class="mb-6"></p>
            <div class="flex justify-end space-x-3">
                <button id="cancel-btn" class="px-4 py-2 bg-gray-600 rounded-lg hover:bg-gray-500 transition-colors">Cancelar</button>
                <button id="confirm-btn" class="px-4 py-2 bg-red-600 rounded-lg hover:bg-red-500 transition-colors">Confirmar</button>
            </div>
        </div>
    </div>

    <!-- Firebase SDKs (Compatível com v8.10.0) -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    
    <!-- Script de Configuração e Inicialização do Firebase (CORRIGIDO) -->
    <script>
        // CORREÇÃO: Inicialização manual do Firebase App, necessária para o deploy no Netlify.
        // *** IMPORTANTE: VOCÊ DEVE SUBSTITUIR AS CHAVES ABAIXO PELAS DE SEU PROJETO 'oficina-fg-motos' ***
        const firebaseConfig = {
            apiKey: "SEU_API_KEY_PUBLICO", 
            authDomain: "SEU_AUTH_DOMAIN",
            projectId: "oficina-fg-motos", // Exemplo, confirme o seu ID real
            storageBucket: "SEU_STORAGE_BUCKET",
            messagingSenderId: "SEU_MESSAGING_SENDER_ID",
            appId: "SEU_APP_ID"
        };
        
        // Verifica se a configuração é válida antes de inicializar
        if (firebaseConfig.apiKey && firebaseConfig.projectId !== "SEU_PROJECT_ID") {
            firebase.initializeApp(firebaseConfig);
        } else if (typeof __firebase_config !== 'undefined') {
             // Fallback para inicialização do ambiente Canvas (se houver)
             try {
                const config = JSON.parse(__firebase_config);
                firebase.initializeApp(config);
             } catch(e) {
                console.error("Firebase Config global não pôde ser analisada.");
             }
        } else {
            console.error("ERRO: O Firebase não foi inicializado. Por favor, preencha o firebaseConfig com suas chaves públicas.");
        }
    </script>
    
    <!-- Script principal do aplicativo (Caminho corrigido) -->
    <script src="js/app.js"></script>
</body>
</html>
